# Telegram —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ø–æ–º–æ—â–Ω–∏–∫

–ë–æ—Ç —É–º–µ–µ—Ç:
- –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∞–∫—Ü–∏—é –ø–æ —Ç–∏–∫–µ—Ä—É;
- –≤—ã–¥–∞–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã (SMA20/50, RSI14);
- —Ä–∏—Å–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã;
- –¥–µ–ª–∞—Ç—å AI-–æ–±–∑–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ —Ç–∏–∫–µ—Ä—É (–µ—Å–ª–∏ –µ—Å—Ç—å `OPENAI_API_KEY`);
- –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ—Ä—Ç—Ñ–µ–ª—å;
- —Å—á–∏—Ç–∞—Ç—å —Ä–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è: –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, –±–µ—Ç–∞ –∫ SPY, VaR 95% (1 –¥–µ–Ω—å);
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ SQLite –∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø–æ –∫–Ω–æ–ø–∫–µ `–ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å`;
- **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Stooq –∏ SEC EDGAR –ø—Ä–∏ rate limit –æ—Ç Yahoo Finance**.

## 1) –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
1. –û—Ç–∫—Ä–æ–π—Ç–µ `@BotFather`.
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `/newbot`.
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω.

## 2) –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## 3) –ù–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env`:
```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
OPENAI_API_KEY=–≤–∞—à_openai_api_key   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
OPENAI_MODEL=gpt-4o-mini
PORTFOLIO_DB_PATH=portfolio.db
TELEGRAM_MAIN_MINI_APP_URL=https://your-mini-app.example.com   # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
TELEGRAM_MAIN_MINI_APP_BUTTON_TEXT=Open App                    # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

### Main Mini App (–∫–Ω–æ–ø–∫–∞ –º–µ–Ω—é)
–ß—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å Mini App –∏–∑ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é (–∫–∞–∫ –≤ Telegram docs `Launching the Main Mini App`), —É–∫–∞–∂–∏—Ç–µ:
- `TELEGRAM_MAIN_MINI_APP_URL` ‚Äî HTTPS URL Mini App;
- `TELEGRAM_MAIN_MINI_APP_BUTTON_TEXT` ‚Äî —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏.

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –æ–Ω –≤—ã–∑–æ–≤–µ—Ç `setChatMenuButton` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–Ω–æ–ø–∫—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —á–∞—Ç–æ–≤.
–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ –≥–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Mini App –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –ø—É—Ç–∏ `/miniapp`, —Ç–æ –µ—Å—Ç—å –æ–±—ã—á–Ω–æ:
`https://–≤–∞—à-–¥–æ–º–µ–Ω/miniapp`.
–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω `WEB_API_TOKEN`, —É–∫–∞–∂–∏—Ç–µ URL —Å query-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º:
`https://–≤–∞—à-–¥–æ–º–µ–Ω/miniapp?api_key=–í–ê–®_WEB_API_TOKEN`.

## 4) –ó–∞–ø—É—Å–∫ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º

### ‚ö° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã)

**–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞:**
```bash
./start_bot.sh
```
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –±–æ—Ç–∞
- –ó–∞–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä
- –°–æ—Ö—Ä–∞–Ω–∏—Ç PID –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:**
```bash
./status_bot.sh
```
–ü–æ–∫–∞–∂–µ—Ç:
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –±–æ—Ç
- PID –ø—Ä–æ—Ü–µ—Å—Å–∞
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤

**–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞:**
```bash
./stop_bot.sh
```
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –±–æ—Ç–∞.

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
```bash
tail -f bot.log
```

### üìù –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
python bot.py
```
‚ö†Ô∏è –ü—Ä–∏ —Ä—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ –º–æ–∂–Ω–æ —Å–ª—É—á–∞–π–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–∞–º.

## –§–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞ –≤ –±–æ—Ç–µ
### –ê–Ω–∞–ª–∏–∑ –∞–∫—Ü–∏–∏
–ü—Ä–æ—Å—Ç–æ —Ç–∏–∫–µ—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- `AAPL`
- `MSFT`

### –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è
–û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ –ø–æ–∑–∏—Ü–∏—è:
- `TICKER QTY AVG_PRICE`

–ü—Ä–∏–º–µ—Ä:
```text
AAPL 10 170
MSFT 4 320
TSLA 3
```

## –ö–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏
- `/start` - —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ –º–µ–Ω—é.
- `/help` - —Ñ–æ—Ä–º–∞—Ç –≤–≤–æ–¥–∞.
- `/myportfolio` - –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è.
- –ö–Ω–æ–ø–∫–∏: `–ê–Ω–∞–ª–∏–∑ –∞–∫—Ü–∏–∏`, `–ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—Ç—Ñ–µ–ª—è`, `–ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å`, `–ü–æ–º–æ—â—å`.

## –í–∞–∂–Ω–æ
- –≠—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π/—É—á–µ–±–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫, –∞ –Ω–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è.
- –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç—è–Ω—É—Ç—Å—è —á–µ—Ä–µ–∑ `yfinance`.
- –ï—Å–ª–∏ `OPENAI_API_KEY` –Ω–µ –∑–∞–¥–∞–Ω, –±–æ—Ç –¥–µ–ª–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –æ–±–∑–æ—Ä –Ω–æ–≤–æ—Å—Ç–µ–π –±–µ–∑ LLM.
